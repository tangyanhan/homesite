<!DOCTYPE html>
<html lang="en">
<head>
    {% load static %}
    <meta charset="UTF-8">
    <title>Videos Management</title>
    <link href="{% static 'bootstrap-3.3.7/css/bootstrap.css' %}" rel="stylesheet">
    <script src="{% static 'js/jquery-3.1.1.min.js' %}"></script>
    <script src="{% static 'bootstrap-3.3.7/js/bootstrap.js' %}"></script>
    <script src="{% static 'js/search-bar.js' %}"></script>
    <script>
        $(document).ready( function(){
            loadDir("")
        })

        function stringEndsWith(str,c) {
            if(str==undefined || str.length == 0) return false

            return str.charAt( str.length - 1 ) == c
        }

        function loadDir(dir) {
            if(dir==undefined) {
                dir = ""
            }

            $.post("{% url 'load-dir' %}", { 'dir':dir, 'csrfmiddlewaretoken': getCookie('csrftoken')},
                function(data,status){
                if(status == "success"){
                    var currentDir = data['currentDir']
                    if( currentDir.length > 0 && currentDir[currentDir.length-1] != '/' ) {
                        currentDir += '/'
                    }
                    var list = data['files']

                    $("#import_dir").click( function(){
                        importDir(currentDir)
                        })

                    dirName = (currentDir.length > 0) ? currentDir : "/"
                    $("#dirname").text(dirName)

                    var fileList = $("#filelist")
                    fileList.empty()

                    if( currentDir.length > 0 ) {
                        li = document.createElement("li")
                        event = 'loadDir("' + currentDir + '..")'
                        li.setAttribute("onclick",event)
                        li.setAttribute("class","btn btn-link")
                        li.innerHTML = '..'
                        fileList.append(li)
                    }

                    for(var i=0; i<list.length; i++) {
                        var entry = list[i]

                        li = document.createElement("li")

                        li.innerHTML = entry.file
                        if(entry.isdir){
                            path = currentDir + entry.file
                            event = 'loadDir("' + path + '")'
                            li.setAttribute("onclick",event)
                            li.setAttribute("class","btn btn-link")
                        }

                        fileList.append(li)
                    }
                }
		    })
        }

        function importDir(dir){
            $.post("{% url 'load-dir' %}", { 'dir':dir, 'csrfmiddlewaretoken': getCookie('csrftoken')},
                function(data,status){
                if(status == "success"){
                    //TODO: to be implemented
                }
            })
        }

        function checkAll(){

        }
        function checkReverse(){
        }
    </script>
</head>
<body>
{% include 'nav.html' %}

<ul id="myTab" class="nav nav-tabs">
	<li class="active">
		<a href="#import" data-toggle="tab">
			 Import
		</a>
	</li>
    <li><a href="#videos" data-toggle="tab">Videos</a> </li>
	<li><a href="#ios" data-toggle="tab">iOS</a></li>
	<li class="dropdown">
		<a href="#" id="myTabDrop1" class="dropdown-toggle"
		   data-toggle="dropdown">Java
			<b class="caret"></b>
		</a>
		<ul class="dropdown-menu" role="menu" aria-labelledby="myTabDrop1">
			<li><a href="#jmeter" tabindex="-1" data-toggle="tab">jmeter</a></li>
			<li><a href="#ejb" tabindex="-1" data-toggle="tab">ejb</a></li>
		</ul>
	</li>
</ul>
<div id="myTabContent" class="tab-content">
	<div class="tab-pane fade in active panel panel-primary" id="import">
        <div class="panel-heading"><h2 id="dirname" class="panel-title"></h2></div>
        <ul class="panel-body" id="filelist">
        </ul>
        <div class="panel-footer clearfix">
            <div class="pull-right">
                <button id="import_dir" class="btn btn-primary">Import</button>
            </div>
        </div>
	</div>
	<div class="tab-pane fade" id="ios">
		<p>iOS 是一个由苹果公司开发和发布的手机操作系统。最初是于 2007 年首次发布 iPhone、iPod Touch 和 Apple
			TV。iOS 派生自 OS X，它们共享 Darwin 基础。OS X 操作系统是用在苹果电脑上，iOS 是苹果的移动版本。</p>
	</div>
	<div class="tab-pane fade" id="jmeter">
		<p>jMeter 是一款开源的测试软件。它是 100% 纯 Java 应用程序，用于负载和性能测试。</p>
	</div>
	<div class="tab-pane fade" id="ejb">
		<p>Enterprise Java Beans（EJB）是一个创建高度可扩展性和强大企业级应用程序的开发架构，部署在兼容应用程序服务器（比如 JBOSS、Web Logic 等）的 J2EE 上。
		</p>
	</div>

    <div class="tab-pane fade panel panel-primary" id="videos">
        <div class="panel-heading">
            <h3 class="panel-title">Databases</h3>
        </div>
        <div class="panel-body">
            <table class="table table-bordered">
                <tr>
                    <th><input id="check-all" type="checkbox" class="checkbox checkbox-inline"></th>
                    <th>Title</th>
                </tr>
                <tr>
                    <td><input type="checkbox"></td>
                    <td>A Title</td>
                </tr>
                <tr>
                    <td><input type="checkbox"</td>
                    <td>B Title</td>
                </tr>
            </table>
        </div>
        <div class="panel-footer clearfix">
            <div class="pull-right">
                <a href="#" class="btn btn-default">Edit</a>
                <a href="#" class="btn btn-primary">Done</a>
                <a href="#" class="btn btn-danger">Delete</a>
            </div>
        </div>
    </div>
</div>

</body>
</html>