<head>
	{% load static %}
	<script type="text/javascript" src="{% static 'js/jquery-3.1.1.min.js' %}"></script>

	<link href="{% static 'bootstrap-3.3.7/css/bootstrap.css' %}" rel="stylesheet">
	<link rel="stylesheet" type="text/css" href="{% static 'css/video-thumb.css' %}">
	<script type="text/javascript" src="{% static 'js/video-thumb.js' %}"></script>
	<link href="http://vjs.zencdn.net/6.2.4/video-js.css" rel="stylesheet">

	<!-- If you'd like to support IE8 -->
	<script src="http://vjs.zencdn.net/ie8/1.1.2/videojs-ie8.min.js"></script>
	<style>

    video{
        background-color: #424242;
    }
    #videos{
        padding:0;
    }

	</style>
	<script>
    $(document).ready( function(){
      loadRate(0)
      loadRecommendVideos()

      $("button.glyphicon.glyphicon-thumbs-up").click( function(){
        loadRate(1)
      } )

      $("button.glyphicon.glyphicon-thumbs-down").click( function(){
        loadRate(-1)
      } )

      $("video,#vidStatus").click(function(){
        var video = $("video")[0]
        if( video.paused ) {
          video.play()
          $("#vidStatus").attr("class","fui-pause")
          $("#vidStatus").hide()
        }else{
          video.pause()
          $("#vidStatus").attr("class","fui-play")
          $("#vidStatus").show()
        }
      })
    });
    function loadRate(option){
      	$.post("{% url 'rate-video' %}", { 'id':{{ video }}, 'op':option,'csrfmiddlewaretoken': getCookie('csrftoken')},
			function(data,status){
			if(status == "success"){
				//var counts = JSON.parse(data)
				likeCount = data["like"]
				dislikeCount = data["dislike"]

				$("button.glyphicon.glyphicon-thumbs-up").text(likeCount)
				$("button.glyphicon.glyphicon-thumbs-down").text(dislikeCount)
			}
		})
    }

    function loadRecommendVideos(){
      $.post("{% url 'recommend-videos' %}", { 'id':{{ video }}, 'csrfmiddlewaretoken': getCookie('csrftoken') },
        function(data,status){
          var vidList = $("#videos")
          vidList.empty()
          var videos = data['videos']
          for( var i=0; i<videos.length; i++ ) {
            video = videos[i]
            li = createThumbFromVideo(video)
            vidList.append(li)
          }
      })
    }

	</script>
</head>

<body>

{% include 'nav.html' %}

<div class="container body-container">
	<video class="video-js vjs-default-skin vjs-16-9" controls="controls" preload="auto"
		   poster="{% static 'cover' %}/{{ video }}.png" data-setup="{}">
		<source src="{% url 'stream' video %}" type="video/mp4">
		<p class="vjs-no-js">
			To view this video please enable JavaScript, and consider upgrading to a web browser that
			<a href="http://videojs.com/html5-video-support/" target="_blank">supports HTML5 video</a>
		</p>
	</video>

	<script src="http://vjs.zencdn.net/6.2.4/video.js"></script>

	<div>
		<button type="button" class="btn btn-default glyphicon glyphicon-thumbs-up"></button>
		<button class="btn btn-default glyphicon glyphicon-thumbs-down"></button>
	</div>
	<br>
	<ul id="videos">
	</ul>
</div>

<script type="text/javascript" src="{% static 'bootstrap-3.3.7/js/bootstrap.js' %}"></script>
<script type="text/javascript" src="{% static 'js/search-bar.js' %}"></script>
</body>
