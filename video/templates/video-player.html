<head>
  {% load static %}
  <script type="text/javascript" src="{% static 'js/jquery-3.1.1.min.js' %}"></script>

  <link href="{% static 'bootstrap-3.3.7/css/bootstrap.css' %}" rel="stylesheet">
  <!-- link href="{% static 'css/stylesheet.css' %}" rel="stylesheet" -->
  <style>
    .fa.fa-thumbs-up, fa.fa-thumbs-down{
      cursor:pointer;
    }

    #vidStatus{
      /* Center */
      position: absolute;
      margin: auto;
      top: 0; left: 0; bottom: 0; right: 0;
      width:100px;
      height:60px;
      color:white;
      background:black;
      opacity:0.7;
      border-radius:6px;
      border-width:0;
      z-index:5;
    }

  </style>
  <script>
    $(document).ready( function(){
      loadRate(0)
      loadRecommendVideos()

      $("i.glyphicon.glyphicon-thumbs-up").click( function(){
        loadRate(1)
      } )

      $("i.glyphicon.glyphicon-thumbs-down").click( function(){
        loadRate(-1)
      } )

      $("video #vidStatus").click(function(){
        var video = $("video")
        var vidStatus = $("#vidStatus")
        if( video.paused ) {
          video.play()
          vidStatus.setAttribute("class","fui-pause")
          vidStatus.hide()
        }else{
          video.pause()
          vidStatus.setAttribute("class","fui-play")
          vidStatus.show()
        }
      })
    });
    function loadRate(option){
      	$.post("{% url 'rate-video' %}", { 'id':{{ video }}, 'op':option,'csrfmiddlewaretoken': getCookie('csrftoken')},
			function(data,status){
			if(status == "success"){
				//var counts = JSON.parse(data)
				likeCount = data["like"]
				dislikeCount = data["dislike"]

				$("i.glyphicon.glyphicon-thumbs-up").text(likeCount)
				$("i.glyphicon.glyphicon-thumbs-down").text(dislikeCount)
			}
		})
    }

    function loadRecommendVideos(){
      $.post("{% url 'recommend-videos' %}", { 'id':{{ video }} },
        function(data,status){
          var vidList = $("#vid-list")
          vidList.empty()
          var videos = data['videos']
          for( var i=0; i<videos.length; i++ ) {
            vid = videos[i]
            li = document.createElement("li")
            li.setAttribute("class","row")

            thumb = document.createElement("img")
            thumb.src = "/static/thumb/" + vid.id + ".png"
            thumb.setAttribute("class","col-md-4")

            title = document.createElement("i")
            title.innerHTML = vid.title
            title.setAttribute("class","col-md-8")

            li.append(thumb)
            li.append(title)
            vidList.append(li)
          }
      })
    }
  </script>
</head>

<body>

{% include 'nav.html' %}

<div class="container">
<div class="row">
  <div class="col-xs-12 col-md-10">
    <video controls="controls" preload="auto" width="100%" height="auto">
      <source src="{% url 'stream' video %}" type="video/mp4">
    </video>
    <button id="vidStatus"><i class="glyphicon glyphicon-play"></i></button>
    <div class="row">
      <i class="glyphicon glyphicon-thumbs-up"></i>
      <i>   </i>
      <i class="glyphicon glyphicon-thumbs-down"></i>
  </div>
  </div>
  <div class="col-xs-12 col-md-2" style="maigin:0;max-height:400px;overflow:auto;">
      <ul id="vid-list">
      </ul>
  </div>
</div>
</div>
  <script type="text/javascript" src="{% static 'bootstrap-3.3.7/js/bootstrap.js' %}"></script>
  <script type="text/javascript" src="{% static 'js/search-bar.js' %}"></script>
</body>
